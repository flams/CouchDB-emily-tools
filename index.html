<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<title>Olives+Emily development/integration tools</title>

	</head>
	<body>
	
		<section>
			<span data-model="bind: innerHTML, greeting">Default Greeting</span> Olives!<br />
			Choose your greeting : <a href="#" data-event="listen: click, changeLanguage">en</a> | <a href="#" data-event="listen: click, changeLanguage">fr</a>
		</section>

		<script src="/socket.io/socket.io.js"></script>
		<script src="lib/require.js"></script>
	    <script src="lib/Emily.js"></script>
	    <script src="lib/Olives.js"></script>	
	    <script>
	    
	    	require(["Olives/Transport", "Olives/OObject", "Olives/Model-plugin", "Olives/Event-plugin"], function (Transport, OObject, ModelPlugin, EventPlugin) {
	    		
	    		// Create a new UI with a custom model
	    		var ui = new OObject,
	    		
	    		// Initiate a transport using socket.io, can be done only once in the whole application
	    		transport = new Transport(io, location.href);

	    		// In the previously created ui, add a plugin to connect the model to the view
	    		ui.plugins.addAll({
	    			"model": new ModelPlugin(ui.model),
	    			"event": new EventPlugin(ui)
	    		});
	    		
	    		// Specify the UI view
	    		ui.alive(document.querySelector("section"));

	    		ui.changeLanguage = function (event, node) {
	    			// Get the english greeting from the node server
		    		transport.request("Greetingz", {
		    			// Try changing "en" to "fr"!
		    			lang: node.innerHTML
		    		}, function (word) {
		    			ui.model.set("greeting", word);
		    		});
	    		}

	    		
	    	});
	    
	    </script>
	</body>
</html>